---
title: MobX的简单使用
date: 2022-05-22
tags:
  - MobX
  - React
  - 状态管理
author: qinghuanI
location: wuhan
---

MobX 没有 Redux 和 Vuex 那么多概念，样板代码的数量很小，代码可读性和可维护性高

## 创建 store

```ts
// Counter.ts

class Counter {
  count = 0;

  constructor() {
    makeAutoObservable(this);
  }

  setCount = (count: number): void => {
    this.count += count;
  };

  reset = (): void => {
    this.count = 0;
  };
}

export default new Counter();
```

## 从根组件注入 stores

从 App 组件中注入 stores

```tsx
// App.tsx

import ReactDOM from "react-dom/client";
import App from "./App.tsx";
import { Provider } from "mobx-react";

import stores from "./stores/counter.ts";

const rootEl = document.getElementById("root") as HTMLElement;

ReactDOM.createRoot(rootEl).render(
  <Provider stores={stores}>
    <App />
  </Provider>
);
```

## 在组件中使用 stores

- 使用 observer

```tsx
// Example.tsx

import type { ReactElement } from "react";
import { observer, useLocalObservable } from "mobx-react";

import stores from "../stores/counter.ts";

const Example = observer((): ReactElement => {
  const { setCount } = useLocalObservable(() => stores);

  return <button onClick={(): void => setCount(1)}>add</button>;
});

export default Example;
```

- 使用 useObserver

```tsx
// Example.tsx

import type { ReactElement } from "react";
import { useObserver, useLocalObservable } from "mobx-react";

import stores from "../stores/counter.ts";

const Example = (): ReactElement => {
  const localStore = useLocalObservable(() => stores);

  return useObserver(() => <button onClick={(): void => localStore.setCount(1)}>add</button>);
};

export default Example;
```

- 使用 Observer

```tsx
// Example.tsx

import type { ReactElement } from "react";
import { Observer, useLocalObservable } from "mobx-react";

import stores from "../stores/counter.ts";

const Example = (): ReactElement => {
  const localStore = useLocalObservable(() => stores);

  return <Observer>(() => <button onClick={(): void => localStore.setCount(1)}>add</button></Observer>;
};

export default Example;
```
